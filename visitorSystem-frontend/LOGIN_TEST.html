<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登录测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-section {
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .test-button {
            background: #1890ff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #40a9ff;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background: #f6ffed;
            border: 1px solid #b7eb8f;
            color: #52c41a;
        }
        .error {
            background: #fff2f0;
            border: 1px solid #ffccc7;
            color: #ff4d4f;
        }
    </style>
</head>
<body>
    <h1>登录功能测试</h1>
    
    <div class="test-section">
        <h2>分判商登录测试</h2>
        <p>测试账号: bjadmin / 123456</p>
        <button class="test-button" onclick="testSubcontractorLogin()">测试分判商登录</button>
        <div id="subcontractor-result" class="result" style="display: none;"></div>
    </div>
    
    <div class="test-section">
        <h2>管理员登录测试</h2>
        <p>测试账号: admin / 123456</p>
        <button class="test-button" onclick="testAdminLogin()">测试管理员登录</button>
        <div id="admin-result" class="result" style="display: none;"></div>
    </div>
    
    <div class="test-section">
        <h2>错误账号测试</h2>
        <p>测试账号: wronguser / wrongpass</p>
        <button class="test-button" onclick="testWrongLogin()">测试错误账号</button>
        <div id="wrong-result" class="result" style="display: none;"></div>
    </div>

    <script>
        // 模拟登录函数
        async function mockLogin(username, password) {
            return new Promise((resolve) => {
                setTimeout(() => {
                    const subcontractorAccounts = [
                        { username: 'bjadmin', password: '123456', id: '1', name: '北京建筑公司' },
                        { username: 'shadmin', password: '123456', id: '2', name: '上海建设集团' },
                        { username: 'gzadmin', password: '123456', id: '3', name: '广州工程公司' },
                        { username: 'szadmin', password: '123456', id: '4', name: '深圳建筑集团' },
                        { username: 'cdadmin', password: '123456', id: '5', name: '成都建设公司' }
                    ];
                    
                    const adminAccounts = [
                        { username: 'admin', password: '123456', id: 'admin1' },
                        { username: 'superadmin', password: 'super123', id: 'admin2' },
                        { username: 'manager1', password: 'mgr123', id: 'admin3' },
                        { username: 'manager2', password: 'mgr456', id: 'admin4' },
                        { username: 'system', password: 'sys123', id: 'admin5' }
                    ];
                    
                    // 检查分判商账号
                    const subcontractorAccount = subcontractorAccounts.find(acc => 
                        acc.username === username && acc.password === password);
                    if (subcontractorAccount) {
                        resolve({ success: true, role: 'subcontractor', account: subcontractorAccount });
                        return;
                    }
                    
                    // 检查管理员账号
                    const adminAccount = adminAccounts.find(acc => 
                        acc.username === username && acc.password === password);
                    if (adminAccount) {
                        resolve({ success: true, role: 'admin', account: adminAccount });
                        return;
                    }
                    
                    resolve({ success: false });
                }, 1000);
            });
        }
        
        async function testSubcontractorLogin() {
            const resultDiv = document.getElementById('subcontractor-result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '测试中...';
            
            try {
                const result = await mockLogin('bjadmin', '123456');
                if (result.success) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        <strong>登录成功！</strong><br>
                        角色: ${result.role}<br>
                        用户名: ${result.account.username}<br>
                        公司名称: ${result.account.name}<br>
                        应该跳转到: /distributor/workers
                    `;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '登录失败';
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '测试出错: ' + error.message;
            }
        }
        
        async function testAdminLogin() {
            const resultDiv = document.getElementById('admin-result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '测试中...';
            
            try {
                const result = await mockLogin('admin', '123456');
                if (result.success) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        <strong>登录成功！</strong><br>
                        角色: ${result.role}<br>
                        用户名: ${result.account.username}<br>
                        应该跳转到: /dashboard
                    `;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '登录失败';
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '测试出错: ' + error.message;
            }
        }
        
        async function testWrongLogin() {
            const resultDiv = document.getElementById('wrong-result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '测试中...';
            
            try {
                const result = await mockLogin('wronguser', 'wrongpass');
                if (result.success) {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = '意外成功 - 这不应该发生';
                } else {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = '正确拒绝 - 登录失败';
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = '测试出错: ' + error.message;
            }
        }
    </script>
</body>
</html>
